% bu_ece_thesis.sty  --  March 2004

% Type of degree as a counter:
%   1 - Master of Science Thesis,
%   2 - Doctoral Dissertation,
%   3 - Master of Science Thesis and Doctoral Dissertation
\newcount\degree

% Number of advisors (1 or 2)
\newcount\numadvisors

% Your previous degree(s). If more than one degree, use single spacing
\def\prevdegrees#1{\gdef\@prevdegrees{#1}}
\def\@prevdegrees{}

\def\department#1{\gdef\@department{#1}}

% If you are getting two degrees, use \and between the names.
\def\thisdegree#1{\setbox0\hbox{#1}  %for side effect of setting \@degreeword
  \gdef\@thisdegree{#1}}

% \and is used inside the \thisdegree argument to separate two degrees
\def\and{\gdef\@degreeword{degrees} \par and \par}
\def\@degreeword{degree}

\def\thesisdate#1{\gdef\@thesisdate{#1}}

% Only the year for BU. Month is used by MIT
\def\degreeyear#1{\gdef\@degreeyear{#1}}
\def\defenseyear#1{\gdef\@defenseyear{#1}}

% Since there are multiple readers (at least two), we build
% appropriate boxes for the approval page as the user makes multiple
% calls to \reader
\newbox\@approvalreader

% The \reader command is based on the original MIT \supervisor command. It
% takes three arguments: An argument indicating whether it is first, second,
% third etc., then the name, then the title. For example,
% \reader{First}{John Doe}{Professor of Mathematics}
% For some reason, the name and title must be SINGLE SPACED

\def\reader{\@reader}
\def\@reader#1#2#3{\setbox\@approvalreader\vbox
  {\unvbox\@approvalreader \vskip 2\baselineskip % NO stretchy stuff
  \hspace{-0.22in}\parbox[t]{0.2\textwidth}{#1 Reader}\parbox[t]{0.75\textwidth}{
        \singlespace
        \rule{0.75\textwidth}{0.1mm}\\#2\\#3}}}

% Major professor, should be same as first reader. Goes in abstract page
\def\majorprof#1#2{\gdef\@majorprofname{#1}\gdef\@majorproftitle{#2}}

% Second major professor
\def\majorprofb#1#2{\gdef\@majorprofnameb{#1}\gdef\@majorproftitleb{#2}}

% Third major professor
\def\majorprofc#1#2{\gdef\@majorprofnamec{#1}\gdef\@majorproftitlec{#2}}

% Fourth major professor
\def\majorprofd#1#2{\gdef\@majorprofnamed{#1}\gdef\@majorproftitled{#2}}

%               TITLE BOX PAGE
%
% BU-ECE title box page - first page to fit the cut-out in the front cover
\def\buecethesistitleboxpage{%
  \thispagestyle{empty}
  \vglue 3.6cm
  \fboxsep=10pt\fboxrule=1pt\hglue 1.25cm
  \Ovalbox{\vbox to 6.2cm{\vfill\hbox{\vtop{\hsize=9.7cm\parindent=0pt
        \renewcommand{\baselinestretch}{1.5}
        \bf\sffamily\begin{center}\MakeUppercase{\@title}\end{center}
        \sl\sffamily\begin{center}\MakeUppercase{\@author}\end{center}
        \rm\sffamily
        \ifcase\degree\or\thisdegree{Master of Science}\or
                         \thisdegree{Doctor of Philosophy}\or
                         \thisdegree{\gdef\@degreeword{degrees}
                           Master of Science \and Doctor of Philosophy}
                         \fi
        \centerline{\ifcase\degree\or Thesis \or Dissertation \or Dissertation\fi
                    submitted in partial fulfillment}
        \centerline{of the requirements for the \@degreeword\ of}
        \centerline{\@thisdegree}}}\vfill}}
    \vglue 6.0cm\hglue 4.5cm
    \vglue -1.0cm\hglue 4.5cm\includegraphics[width=4.0cm]{BUlogo_cmyk.eps}\\
    \clearpage\mbox{}\thispagestyle{empty}\clearpage
  \setcounter{page}{1}}


%               PRELIMINARY PAGES
%
% ``The preliminary pages -- title page, copyright page, reader's
% approval page, etc. -- are numbered with lower-case Roman numerals
% (i, ii, iii,).'' No page number on the title page, although it
% counts as page #i. This command is undone at the beginning of the
% text with the command \endofprelim (see below)
%
% According to the BU guide the correct order for preliminary pages is:
% title, copyright (optional), approval,  acknowledgments (opt.),
% abstract, preface (opt.), Table of contents, List of tables (if
% any), List of illustrations (if any).

% TITLE PAGE
% You can use the titlepage environment to do it all yourself if you
% don't want to use \maketitle.
\def\titlepage{\newpage \thispagestyle{empty}
\parindent 0pt
\def\baselinestretch{1.8}
\parskip 8pt plus 1fill
\@normalsize
\begin{center}
}
\def\endtitlepage{\end{center}\newpage}

% Got tired of screwing around with \parskips that refuse to stretch,
% so I manually put a \vfill after each \par.
\def\maketitle{\begin{titlepage}
\pagenumbering{roman}
\large
\BU\\\COE\par\vfill
\ifcase\degree\or Thesis \or Dissertation \or Dissertation \fi\par\vfill
\MakeUppercase{{\bf \@title}}\par\vfill
by\par\vfill
\MakeUppercase{{\bf \@author}}\\
\begin{singlespace}
\@prevdegrees
\end{singlespace}
\ifcase\degree\or\thisdegree{Master of Science}\or
                 \thisdegree{Doctor of Philosophy}\or
                 \thisdegree{Master of Science \and Doctor of Philosophy}
                 \fi
\par\vfill
Submitted in partial fulfillment of the\\
requirements for the \@degreeword\ of\\
\@thisdegree\\
\@degreeyear
\end{titlepage}}

%               COPYRIGHT PAGE
% Separate Copyright page. It gets roman numeral ii but the page
% number is not printed. The name must be in allcaps. This page
% MUST NOT be removed or the library will not accept the thesis.
% \def\copyrightpage{\newpage\thispagestyle{empty}
% \null\vfill\par
% \begin{center}\large
% \copyright Copyright by\par
% \@author
% \par
% \@degreeyear
% \end{center}}
\def\copyrightpage{\newpage\thispagestyle{empty}
\null\vfill\par
\begin{singlespace}

\hspace{2in}
\large \copyright \hspace{1ex}
\begin{minipage}[t]{3in}
\@degreeyear \ by \\
\MakeUppercase{\@author}\\
All rights reserved
\end{minipage}
\end{singlespace}}

%               APPROVAL PAGE
% Separate approval page for BU style.
% NO NUMBER on approval page, even if it is page #3. This differs from
% the handbook, but Martha Wellman tells us it is the way to do it,
% and the handbook will be updated.
\def\approvalpage{\newpage\thispagestyle{empty}
\def\baselinestretch{1.2}
\begin{center}\large
Approved by\\[2em]
\unvbox\@approvalreader
\end{center}\newpage}


%               ABSTRACT PAGE

\def\abstractpage{\newpage
\begin{center}
\begin{doublespace}
{\large
\MakeUppercase{{\bf \@title}}\\[1em]%\par
%\ifcase\degree\or\or
%  (Order No. \hspace{1.0in})\\[1em] \or
%  (Order No. \hspace{1.0in})\\[1em] \fi
\MakeUppercase{{\bf \@author}}\\[1em]
\ifcase\degree\or\or
\Bu,\ \Coe, \@degreeyear
\par

% Major Professor: \@majorprofname, \@majorproftitle
\ifcase\numadvisors\or
	\mbox{Major Professor:
	\begin{minipage}[t]{4.5in}
		\vspace*{-0.7\baselineskip}
		\begin{singlespace}
			\flushleft{\@majorprofname \\
				\@majorproftitle}
		\end{singlespace}
	\end{minipage}}
	\or
	\mbox{Major Professors:
	\begin{minipage}[t]{4.5in}
    	\vspace*{-0.7\baselineskip}
    	\begin{singlespace}
    		\flushleft{\@majorprofname \\
    			\@majorproftitle \\ \vspace{3mm}
    			\@majorprofnameb  \\
    			\@majorproftitleb}
    	\end{singlespace}
    \end{minipage}}
    \or
    \mbox{Major Professors:
	\begin{minipage}[t]{4.5in}
		\vspace*{-0.7\baselineskip}
		\begin{singlespace}
			\flushleft{\@majorprofname \\
				\@majorproftitle \\ \vspace{3mm}
				\@majorprofnameb  \\
				\@majorproftitleb \\ \vspace{3mm}
				\@majorprofnamec  \\
				\@majorproftitlec}
		\end{singlespace}
	\end{minipage}}
	\or
	\mbox{Major Professors:
	\begin{minipage}[t]{4.5in}
		\vspace*{-0.7\baselineskip}
		\begin{singlespace}
			\flushleft{\@majorprofname \\
				\@majorproftitle \\ \vspace{3mm}
				\@majorprofnameb  \\
				\@majorproftitleb \\ \vspace{3mm}
				\@majorprofnamec  \\
				\@majorproftitlec \\ \vspace{3mm}
				\@majorprofnamed  \\
				\@majorproftitled}
		\end{singlespace}
	\end{minipage}}
\fi
\par
\vspace{\baselineskip}
\or
\Bu,\ \Coe, \@degreeyear
\par

% Major Professor: \@majorprofname, \@majorproftitle
\ifcase\numadvisors\or
	\mbox{Major Professor:
	\begin{minipage}[t]{4.5in}
		\vspace*{-0.7\baselineskip}
		\begin{singlespace}
			\flushleft{\@majorprofname \\
				\@majorproftitle}
		\end{singlespace}
	\end{minipage}}
	\or
	\mbox{Major Professors:
	\begin{minipage}[t]{4.5in}
		\vspace*{-0.7\baselineskip}
		\begin{singlespace}
			\flushleft{\@majorprofname \\
				\@majorproftitle \\ \vspace{3mm}
				\@majorprofnameb  \\
				\@majorproftitleb}
		\end{singlespace}
	\end{minipage}}
	\or
	\mbox{Major Professors:
	\begin{minipage}[t]{4.5in}
		\vspace*{-0.7\baselineskip}
		\begin{singlespace}
			\flushleft{\@majorprofname \\
				\@majorproftitle \\ \vspace{3mm}
				\@majorprofnameb  \\
				\@majorproftitleb \\ \vspace{3mm}
				\@majorprofnamec  \\
				\@majorproftitlec}
		\end{singlespace}
	\end{minipage}}
	\or
	\mbox{Major Professors:
	\begin{minipage}[t]{4.5in}
		\vspace*{-0.7\baselineskip}
		\begin{singlespace}
			\flushleft{\@majorprofname \\
				\@majorproftitle \\ \vspace{3mm}
				\@majorprofnameb  \\
				\@majorproftitleb \\ \vspace{3mm}
				\@majorprofnamec  \\
				\@majorproftitlec \\ \vspace{3mm}
				\@majorprofnamed  \\
				\@majorproftitled}
		\end{singlespace}
	\end{minipage}}
\fi
\par
\vspace{\baselineskip}
\fi
}
\end{doublespace}
ABSTRACT
\end{center}
}

\def\endabstractpage{\newpage}

%               END OF PRELIMINARY PAGES

%               USEFUL MACROS
\def\BU{BOSTON UNIVERSITY}
\def\Bu{Boston University}
\def\COE{COLLEGE OF ENGINEERING}
\def\Coe{College of Engineering}
